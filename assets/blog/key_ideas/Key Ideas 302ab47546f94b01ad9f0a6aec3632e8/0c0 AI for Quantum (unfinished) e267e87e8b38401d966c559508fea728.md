# 0c0. AI for Quantum (unfinished)

## 슈뢰딩거 방정식을 기계가 발견할 수 있을까?

**관찰과 패턴 찾기, 그리고 공식화에 관하여**

학부 2학년 시절, 양자역학이 궁금해서 한 학년 윗 과목인 양자역학의 응용을 당겨서 들은 적이 있다. 첫번째 수업 시간부터 교수님께서는 머신러닝을 이용하여 양자역학의 제 1 법칙인 슈뢰딩거 방정식조차 발견할 수 없을 것이라는 의견을 밝히셨다. 이 질문은 나를 상당히 끌어당겼다 - 도대체 양자역학이 무엇이길래 인공지능으로도 그 원리를 파악할 수 없다고 하시는 걸까?

"슈뢰딩거 방정식을 발견하다"를 좀 더 구체적으로 정의하자면 "실험 데이터로부터 양자 파동 현상의 패턴을 발견하고, 이를 다른 물리학자와 소통할 수 있는 형태로 만들어 제시하는 것"이다. 만약에 기계가 이러한 작업을 수행할 수 있다면 충분히 “공식 발견”을 한 것으로 인정할 수 있을 것이다. 인공지능은 데이터로부터 슈뢰딩거 방정식을 발견할 수 있을까?

## 기호적 회귀 분석

기계가 스스로 공식을 세우고 데이터로 검증하는 방법론 중 가장 대표적인 예시는 기호적 회귀 분석(symbolic regression)이다. 기호적 회귀 분석은 기계가 스스로 수식을 생성하여 주어진 실험 데이터를 핏팅(fitting)하는 방법론을 다루며, 1990년대 초에 경제학자 존 코자(John Koza)에 의해 시작되어 2000년대에 들어서 본격화되었다. 초창기에는 유전 알고리즘을 이용한 해법이 주를 이뤘으나, 최근 딥러닝의 발달과 함께 AIFeynman과 같은 심층신경망 기반 알고리즘이 등장하기 시작했다.

한 예로, 뉴턴의 제 2법칙 $\mathbf{F}=m\mathbf{a}$를 실험 데이터로부터 “재발견”하고 싶다 하자. 하지만 찾고자 하는 수식이 $\mathbf{F}=m\mathbf{a}$임은 모른다. 기계도 뉴턴처럼 스스로 자연 법칙을 발견할 수 있을까? 편의를 위해, 물체에 가해준 힘 $\mathbf{F}$와 위치 $\mathbf{x}$가 시간에 대한 함수로 주어져 있고, 물체의 질량 $m$도 주어졌다고 가정하자. 만약 적절한 알고리즘이 주어진 변수와 함수를 연산하여 변하지 않는 양, 즉 불변량을 도출한다면, 우리는 “법칙"을 찾은 것이라고 할 수 있다. 예를 들어, $\mathbf{F}-md^2\mathbf{x}/dt^2=\mathbf{0}$이 항상 성립한다는 사실을 알아냈다면, 우리는 힘-가속도 법칙을 발견한 것으로 해석할 수 있다. 따라서, 기호적 회귀 분석은 다음의 손실함수를 최소화하는 것으로 생각할 수 있다:

$$
\mathcal{L}(f_\text{expr}):=\|f_\text{expr}( \mathbf{F},\mathbf{x}, m)\|^2
$$

$\mathcal{F} := \{ \mathbf{\mathbf{v}}: [t_i, t_f] \rightarrow \mathbb{R^3} \}$라 할 때, $\mathbf{F},\mathbf{x}\in\mathcal{F}$는 시간 $t\in [t_i,t_f]$에 대한 함수로 원하는 만큼 미분 가능하며, $f_{\text{expr}}:\mathcal{F}\times\mathcal{F}\times\R^+ \rightarrow \mathcal{F}$는 덧셈, 곱셈, 미분 등 우리가 알고 있는 연산자를 이용하여 만들어낸 올바른 형태의 식, 즉 적형식이다. 또한 노름 $\|\cdot\|:\mathcal{F} \rightarrow \R_0^+$은 아래와 같이 정의할 수 있다:

$$
\|\mathbf{v}\|=\sqrt{\int_{[t_i, t_f]}(\|\mathbf{v}(t)\|_2)^2\;dt}
$$

실험으로부터 실측 데이터를 얻으면, 실제로는 측정 시각 $\{ t_i \}_{i=1,2\cdots,N}$에서의 함수값 $\{\mathbf{F}_i\}_{_{i=1,2\cdots,N}}$, $\{\mathbf{x}_i\}_{i=1,2\cdots,N}$가 이산적으로 주어질 것이다. 그러면,

$$
\mathcal{L}(\mathbf{f}_\text{expr}) = ||\mathbf{f}_\text{expr} (F,X,m)||^2
$$

와 같이 나타낼 수 있으며, 여기서 $F=(F_{ij})$, $X=(X_{ij})$는 $F_{ij}:=(\mathbf{F}(t_i))_j$, $X_{ij}:=(\mathbf{x}(t_i))_j$가 되는 행렬이다. 또한  $\mathbf{f}_\text{expr}:\R^{N\times 3}\times\R^{N\times 3}\times \R^+ \rightarrow \R^{N\times 3}$는 적형식으로 정의할 수 있으며 새로운 노름 $\|\cdot\|:\R^{N\times 3} \rightarrow \R_0^+$는 아래와 같이 정의할 수 있다:

$$
\|V\|=\sqrt{\frac{1}{N}\sum_{i=1}^N \sum_{j=1}^3 V_{ij}^2\;}
$$

너무 복잡한 수식으로 실험 데이터를 피팅할 경우 측정 오차가 수식에 반영되므로, 과적합을 막기 위해 $\mathbf{f}_\text{expr}$는 ‘간단해야' 한다. 여기서 생각해 볼 지점들 몇 가지를 얻는다.

1. 수식의 복잡도를 측정하는 방법에는 무엇이 있는가?
2. 적형식의 개념을 심층신경망에 구조적으로 내포하는 법에는 무엇이 있는가?
    - 좋은 대형 언어 모델이 있어서, 반드시 “수학적으로 말이 되는” 수식만을 생성하도록 제약할 수 있는가?
3. 수식의 의미를 내포하는 적절한 임베딩이 존재하는가? 존재한다면 어떻게 학습해야 하는가?

위와 같은 질문들에 답한다면, 가설(적형식)을 세우고 이를 스스로 데이터로 검증하는 인공지능을 개발하는, 새로운 가능성을 열 수 있을 것이다.

## 양자컴퓨터는 인공지능의 ‘놀거리’

사람이 양자역학을 실험을 통해 밝혀낸 것처럼, 양자컴퓨터를 인공지능의 ‘놀거리’로 가져다주면 아주 재미있는 발견들이 나올 것이다. 인공지능이 적은 실험 데이터로 스스로 양자 현상을 깨치게 하는 것은 사람에게 몇 가지 사례만으로 양자역학을 완전히 이해시키려는 시도와 같다. 인간이 주변 환경과 상호작용하며 실험할 수 없었다면, 인간은 양자 현상에 대해 영영 알지 못했을 수도 있다. 따라서, 양자 현상을 빠른 속도로 마음껏 실험할 수 있는 장치, 즉 양자컴퓨터는 인공지능이 양자역학을 이해함에 있어서 매우 매력적인 부가 장치가 될 것이다.

적어도 지금까지는, 인간 뇌에서 양자역학적인 현상이 중요한 역할을 차지하는 것으로 보여지지는 않는다. 한편, 알파폴드(AlphaFold)를 비롯한 인공지능 시스템은 양자 현상에 대한 고려 없이도 이미 단백질 등 복잡한 분자의 구조를 예측하고 시뮬레이션하는데 탁월한 성능을 보여주었다. 그러나, 성능이 매우 좋은 (백만불짜리) 컴퓨터를 사용해야 했다는 단점이 있으며, 시뮬레이션 할 수 있는 분자의 종류가 단백질로 제한된다는 한계가 있었다.

양자역학 실험 데이터셋이 주어졌을 때 기계 스스로 슈뢰딩거 방정식과 같은 핵심적인 방정식을 스스로 고안할 수 있음을 기호적 회귀분석으로 보일 수 있다면, 양자역학과 지능의 연관성에 관한 새로운 통찰을 제공할 것이다. 양자계산을 위해 머신러닝을 사용하는 가장 간단한 기호적 회귀 분석 방법론을 고안해보자. 먼저 슈뢰딩거 방정식을 쓰면,

$$
\hat{H} \Psi (\mathbf{r}, t) = i\hbar \frac{\partial}{\partial t} \Psi(\mathbf{r}, t)
$$

해밀토니안이 시간에 대해 불변일 때는, 고유값 문제 $\hat{H}ψ(\mathbf{r})= Eψ(\mathbf{r})$의 해들을 찾고 위상자 $e^{-iEt/\hbar}$를 곱해 진행시키면 게임 끝이다.

연산자가 파동함수에 작용하는 것은 선형 변환이 벡터에 작용하는 것으로 해석할 수 있다. 그리고 고유값 문제는 변환 적용 전후에 방향이 불변하는 대칭축을 찾는 문제로 생각할 수 있다. 이러한 ”대칭축“, 즉 고유함수들을 인공신경망으로 근사하여 구할 수 없을까? 고유값 방정식 $\hat{H}ψ = Eψ$를 만족하는 파동함수 $\psi:\R^n\rightarrow\mathbb{C}$를 인공신경망 $\psi_\theta$로 치환하자. 그러면 손실 함수는 어떤 노름 $\|\cdot\|$에 대해 아래와 같이 나타낼 수 있다.

$$
\mathcal{L}(\theta, E)=\|\hat{H}\psi_\theta - E\psi_\theta\|^2
$$

아직 위 접근에는 해결되지 않은 몇몇 문제가 있다. 예를 들어, 위의 노름을 어떻게 정의할 것인가? 한 가능성은 함수 $f$의 노름을 $\|f\|=\sqrt{\mathbb{E}\left[|f(X)|^2\right]},\;\;X \sim \mathcal{N}(\mathbf{0}, I_{n\times n})$와 같이 정의하는 것이다. 하지만 인공신경망으로 정의된 파동함수 $\psi_\theta$는 대단히 복잡하며, 노름에 사용된 기댓값을 계산하기 위해 상당한 연산량이 소모되게 된다. 추가로, (인공신경망으로 정의된) 파동함수에 대한 해밀토니안의 작용을 계산할 방법이 마련되어 있지 않다. 만약에 해밀토니안을 인공신경망으로 또다시 근사한다고 치자. $\theta$의 차원을 $N$이라 할 때, 우리는 인공신경망으로 정의된 연산자 $\hat{H}_\Theta: \R^N \rightarrow \R^N$를 새로이 정의해야 한다.

이처럼 시뮬레이션 대상계의 복잡도에 따라 연산량이 기하급수적으로 증가함을 확인할 수 있다. 이것이 의미하는 것은 무엇인가? 인공지능을 활용한다면 작은 분자 수준의 물리학은 어렵지 않게 시뮬레이션할 수 있다. 그렇지만 정확도에서 타협을 보지 않고 ~10,000개 수준의 더 큰 양자계의 역학을 모사할 수 있을 것으로 보이지는 않는다. 모사 함수를 구하는 것만으로 양자역학을 충분히 잘 묘사할 수 있다면 굳이 양자컴퓨터를 고집할 필요는 없다. 그렇지만, 역설적으로 대규모 양자 실험 데이터를 얻어내는 가장 저렴한 방법이 양자 컴퓨팅이다. 양자 병렬성이 실질적으로 유의미한 도움을 줄 수 있는지, 줄 수 있다면 얼마나 줄 수 있는지 우리는 탐색해보아야 한다.

지금까지 인공신경망에 대해 밝혀진 바에 따르면, 훈련을 통해 다차원 데이터에 내포된 패턴과 구조를 학습하고, 차원 축소(dimensionality reduction) 기법을 통해 밝혀진 정보를 압축적으로 표현할 수 있다. 그리고 이렇게 벡터로 저장된 정보를 사람이 볼 수 있는 공식으로 매핑하는 것 역시 자연어 처리를 활용한다면 충분히 가능하다. 양자 현상을 기계가 스스로 발견할 수 없다는 사실은 인공지능의 발전 속도로 미루어볼 때 오히려 말이 되지 않아 보이지만, 계의 복잡도에 따라 연산량이 기하급수적으로 늘어나는 양자 현상의 특성을 고려한다면, 교수님이 말씀이 그다지 틀린 말이 아닐 수 있겠다는 생각이 점점 든다.

요약하자면, 처음 던졌던 질문 “양자역학은 과연 사람만이 이해할 수 있는 현상일까?”와 같이 평소였으면 추상적이고 막연했을 물음에 대해 인공신경망은 해결의 실마리를 제공하고 있다. 아울러, 양자 컴퓨팅의 결과를 기계학습의 학습 데이터로 사용할 때 - 즉 양자 컴퓨터를 인공지능의 “놀거리”로 제공할 때 - 양자컴퓨터를 사용하지 않을 때에 비해 동일 연산량 기준 인공신경망이 달성할 수 있는 예측 오차가 어떠한 경향성을 가지고 줄어드는지를 탐구한다면 인공지능의 양자역학적 이해에 관한 탐구를 확장하고 이해의 깊이를 달리할 수 잇을 것으로 사료된다. 과연 인공지능은 양자 현상을 기술할 수 있을까? 처음과 동일한 질문으로 글을 마친다.