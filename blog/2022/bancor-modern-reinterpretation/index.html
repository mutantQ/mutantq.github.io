<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> A Modern Reinterpretation of Keynes’ Bancor and the International Clearing Union | Yejun Jang </title> <meta name="author" content="Yejun Jang"> <meta name="description" content="Studying a Hypothetical International Currency through Multi-Agent Reinforcement Learning"> <meta name="keywords" content="reinforcement-learning, deep-learning, multi-agent-systems, AI-research"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://codingjang.github.io/blog/2022/bancor-modern-reinterpretation/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Yejun</span> Jang </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/books/">bookshelf </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">A Modern Reinterpretation of Keynes’ Bancor and the International Clearing Union</h1> <p class="post-meta"> Created on December 14, 2022 </p> <p class="post-tags"> <a href="/blog/2022"> <i class="fa-solid fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/economics"> <i class="fa-solid fa-hashtag fa-sm"></i> economics</a>   <a href="/blog/tag/international-trade"> <i class="fa-solid fa-hashtag fa-sm"></i> international-trade</a>   <a href="/blog/tag/reinforcement-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> reinforcement-learning</a>   <a href="/blog/tag/multi-agent-systems"> <i class="fa-solid fa-hashtag fa-sm"></i> multi-agent-systems</a>   <a href="/blog/tag/keynes"> <i class="fa-solid fa-hashtag fa-sm"></i> keynes</a>   <a href="/blog/tag/bancor"> <i class="fa-solid fa-hashtag fa-sm"></i> bancor</a>   <a href="/blog/tag/marl"> <i class="fa-solid fa-hashtag fa-sm"></i> marl</a>   <a href="/blog/tag/simulation"> <i class="fa-solid fa-hashtag fa-sm"></i> simulation</a>   <a href="/blog/tag/monetary-policy"> <i class="fa-solid fa-hashtag fa-sm"></i> monetary-policy</a>   <a href="/blog/tag/international-relations"> <i class="fa-solid fa-hashtag fa-sm"></i> international-relations</a>   <a href="/blog/tag/english"> <i class="fa-solid fa-hashtag fa-sm"></i> english</a>   ·   <a href="/blog/category/essay"> <i class="fa-solid fa-tag fa-sm"></i> essay</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="abstract">Abstract</h2> <p>Our work reevaluates John Maynard Keynes’ proposal of an international currency and the Clearing Union through the lens of modern economics and reinforcement learning. It explores the historical shift from the Bretton Woods System to the current floating exchange rate regime, focusing on Keynes’ Bancor plan designed to address global trade imbalances. The paper introduces a mathematical model of the Bancor system, emphasizing its unique trade balancing mechanisms. It models nations as independent reinforcement learning agents, which may cooperate to minimize global economic disparities. This approach integrates economic simulations and international relations dynamics, presenting a novel framework for managing global economic challenges and enhancing international economic cooperation.</p> <h2 id="a-brief-history-of-world-currencies">A Brief History of World Currencies</h2> <p>The current international trade is based on the Kingston System, where the exchange rate between currencies may float and be subject to change. This was not always the case - after the US rose as the world’s economic superpower by the end of World War II, the Bretton Woods System, established in July 1944, fixed the exchange rate between the dollar and each nation’s currency, and pegged the value of the dollar to a fixed amount of gold. It was only after the Nixon Shock in August 1971, when the US suspended the convertibility of its dollar to gold, that the floating exchange rate was used.</p> <p>In the Bretton Woods Conference, there were two main figures - John Maynard Keynes from the United Kingdom and Harry Dexter White from the United States. Keynes proposed the use of an International Currency named Bancor, whereas White suggested the use of the US dollar, in international trade settings.</p> <p>Keynes’ proposal consisted of the Bancor currency and the International Clearing Union (ICU). As the name of the union suggests, Keynes’ plan aimed to prevent excessively large trade imbalances between countries. We will refer to it as the Clearing Union, since the international setting is obvious. In this system, countries are given quotas to limit the amount of trade deficit or surplus, and the negative control loop of the Bancor minimizes the trade imbalances, and ideally, zeros them out. In fact, Keynes mentions:</p> <blockquote> <p>The problem of maintaining equilibrium in the balance of payments between countries has never been solved … the failure to solve this problem has been a major cause of impoverishment and social discontent and even of wars and revolutions. John Maynard <em>Keynes (1941)</em></p> </blockquote> <p>It is now widely acknowledged that large trade deficits, and corresponding massive capital inflows, preceded and contributed to fuel economic bubbles, according to <a href="https://academic.oup.com/book/35368/chapter-abstract/301076908?redirectedFrom=fulltext" rel="external nofollow noopener" target="_blank">Hirai et. al. (2013)</a>. Although the exact cause-and-effect relationship still remains unknown, Hirai et. al., in their paper, argue that the issue of excessive trade deficits and foreign exchange reserves are a structural problem, which can be alleviated by reconsidering Keynes’ proposal in the Bretton Woods Conference.</p> <p>However, with the US winning both World Wars and holding more than 70% of the world’s gold back in 1944, White’s plan to peg the dollar to gold and establishing it as an international currency, was better accepted by the participating nations. The use of the dollar in international trades, allowed the US to utilize it as a source of seigniorage, which is the free revenue generated by issuing the currency. It also made possible the reduction in interest rates for their treasury bonds, since the stable value of the dollar attracted more investors.</p> <h2 id="keynes-plan">Keynes’ Plan</h2> <p>But the privilege, while yielding seigniorage, came with its own cost, such as the risk of accruing massive trade deficits and the challenge of maintaining effective monetary policy. Most importantly, it allowed the accumulation of global imbalances which may lead to escalated global tensions and destabilized global economy.</p> <p>One such example of a persistent imbalance would be the foreign exchange reserves, and the largest of them being China’s. The Chinese foreign exchange reserve is unreasonably large at 3.12 trillion USD, which is already the largest in the world, and is speculated to have an additional 3 trillion USD worth of ‘hidden’ reserves across the world, according to <a href="https://www.bloomberg.com/news/articles/2023-06-30/china-has-3-trillion-of-hidden-currency-reserves-setser-says" rel="external nofollow noopener" target="_blank">Setser (2023)</a>. If these assets are released abruptly to the market, it may cause significant economic disruptions worldwide. In fact, Setser mentions in his <a href="https://www.cfr.org/blog/chinas-rising-holdings-us-agency-bonds" rel="external nofollow noopener" target="_blank">article</a> that China’s massive purchase of the US Agency bonds pushed private investors into riskier securities, fueling the 2007-2008 Financial Crisis. The adoption of Keynes’ proposal will have significant implications for South Korea as well, because it has a history of being heavily hit by the Asian Financial Crisis in 1997, and since then have maintained a huge foreign exchange reserve.</p> <p>The problem of global imbalances can potentially be addressed by Keynes’ Proposal. There are two key differences that set aside the Bancor-ICU system from other world currencies:</p> <ol> <li>It is created <em>ex nihilo</em> - The Bancor is created only when trade imbalance is occurred, and is destructed when it is reabsorbed.</li> <li>The burden of adjustment is distributed symmetrically between debtors and creditors.</li> </ol> <h3 id="our-contribution">Our contribution</h3> <p>We model Keynes’ Bancor and the Clearing Union mathematically, and set up a Multi-Agent Reinforcement Learning (MARL) objective to study the Bancor’s potential advantages and drawbacks. Studying Keynes’ plan cannot be done solely through data, as Bancor is a hypothetical currency that has never been put to use in practice. We discover that the Bancor and the Clearing Union’s goal can be expressed as a minimization problem, which we will approach to solve using cooperative MARL.</p> <h3 id="notations">Notations</h3> <ul> <li>For time dependent variables, $t$ is used to denote time, whether continuous or discrete. (ex: $y(t),\;Z(t)$)</li> <li>Any variable with one or two indices implies a vector or a matrix, and vice versa. For example, the variable $y_i$ with one index $i$ implies the existence of a column vector $y=(y_i)$, and the variable $Z_{ij}$ implies the matrix $Z=(Z_{ij})$.</li> <li> <p>For a matrix $Z$, $Z^D$ is the diagonal part of $Z$, $Z^*=Z-Z^D$ is the matrix obtained by zeroing its diagonals, and $Z^S=(\sum_{j}Z_{ij})$ is the vector created by summing over each row of $Z$. Also, given the vector $z=(z_i)$, we define the operation $\mathrm{diag}(z)=(\mathrm{diag}(z)_{ij})$ and its inverse operation as:</p> \[\begin{align*} \mathrm{diag}(z)_{ij}=\begin{cases} z_i, &amp; \text{if } i = j\\ 0, &amp; \text{if } i \neq j \end{cases}\;,\;\;\mathrm{diag}^{-1}(Z)_i=(Z_{ii}). \end{align*}\] </li> <li>$\star$ denotes the element-wise multiplication of tensors with equal size.</li> <li>The indices $i$ and $j$ run through ${1,2,\cdots,n}$, unless otherwise mentioned.</li> </ul> <h3 id="the-bancor">The Bancor</h3> <p>A mathematical description of the Bancor is given below.</p> <p>Suppose $n$ countries have joined the Clearing Union. Each nation is associated with one account, which is initialized to zero. The account is denominated in a new, international unit of account, the ‘Bancor’. Letting $i \in {1,2,\cdots,n}$, and writing the amount of Bancor in the $i$-th country’s account at time $t$ as $b_i(t)$,</p> \[b_i(t)=0 \;\; \text{for} \; \;t\le s_i.\] <p>Where $s_i$ is the time the $i$-th country joined the clearing union. Let’s narrow our focus to two countries, $i$ and $j$. When the cumulative net export $NX_{ij}(t)$ from $i$ to $j$ is positive, $i$ is said to have gained a trade surplus, and $j$ is said to be running a trade deficit. The accounts keep track of these imbalances - country $i$ gains Bancors and the country $j$ loses Bancors. Assuming $t&gt;s_i$ for all $i$, and denoting the cumulative export from $i$ to $j$ during the interval $[\max{s_i,s_j},t]$ in Bancors as $X_{ij}(t)$,</p> \[\begin{align*} NX_{ij}(t)=X_{ij}(t)-X_{ji}(t),\\b_i(t)=NX^S_i(t)=\sum_{j=1}^n {NX_{ij}(t)}. \end{align*}\] <h3 id="minimization-of-global-imbalances">Minimization of Global Imbalances</h3> <p>$NX(t)$ is antisymmetric. Since the summation of Bancors over all accounts, or $\sum_i b_i(t)$, is equal to the summation over all elements of the matrix $NX_{ij}(t)$ (which is zero), it is indeed true that the Bancor is created <em>ex nihilo</em>. Hirai et. al. clarifies that Keynes’ system does not block capital movement and efficient allocation of savings, and instead addresses the problem of ‘persistent’ imbalances - the credits and debits that have accumulated without connection to actual investments or repayment. This is easily seen from the equation, since $X_{ij}(t)$ and $X_{ji}(t)$ need not be zero for $NX_{ij}(t)$ to be zero.</p> <p>Because the accounts are centralized at the Clearing Union, the credit and debit is multilateral, meaning the credits gained due to a surplus in one country can be spent with any other member countries. Therefore, exporting to any member country will reduce a country’s debit. In this way, the Clearing Union can finance international trade without any given amount of money, provided that the system is trusted globally.</p> <p>Keynes viewed global imbalances as the root cause of many of the world’s problems. D.H. Robertson, the British economist who participated with Keynes in the Bretton Woods Conference stated:</p> <blockquote> <p>It is arguable that the proudest day in the life of the Manager of the Clearing Union would be that on which, as a result of the smooth functioning of the correctives set in motion by the Plan, there were no holders of international money—on which he was able to show a balance sheet with zero on both sides of the account. Robertson (1943)</p> </blockquote> <p>Mathematically speaking, $b_i(t)=0$ for all $i$ is preferable. To realize this, both debtors and creditors are subject to the payment of periodic charges, proportional to the size of the imbalance. This might sound counterintuitive at first, especially because not only the debtor but the creditor has to pay for net exports. But, when we frame Keynes’ idea as an optimization problem, it becomes evident why this is necessary. Let $\mathbf{b}(t)\in\mathbb{R}^n$ denote the ordered tuple of account balances of all countries. Then the objective becomes</p> \[\text{minimize}\int_0^\infty ||b(t)||_1dt=\int_0^\infty \left(\sum_{i=1}^n|b_i(t)|\right)dt,\] <p>Provided that the integral converges. A discretized version of this would be:</p> \[\text{minimize}\sum_{t=0}^\infty||b(t)||_1=\sum_{t=0}^\infty\sum_{i=1}^n |b_i(t)|\] <p>We again assume that the summation converges. Since this is the minimization of a sum of absolute values, it is minimized if and only if $b_i(t)=0$ for all $i\in{1,2,\cdots,n}$ and $t\in{0,1,2\cdots}$. To accomplish this, we can penalize each nation for accumulating debits or credits. We can see from this objective how leaving the creditor free of charge would not solve the problem of accumulating trade imbalances. Any country that can issue a world currency can use expansionary monetary policies and leave the financial burden behind to the rest of the world, which may lead to negative consequences, as Keynes’ pointed out in his works. He attempts to solve exactly this, with the Bancor and the Clearing Union.</p> <p>In addition to this ‘carrying cost’, The balances in each account are bounded from above and below - in other words, a country’s limit, or the ‘quota’ is given by the Clearing Union, in proportion to the trade volume of that country. Once the upper limit is reached, its national currency is revaluated to incentivize the import from other countries. Once the lower limit is reached, the currency is devaluated to promote the export of the country’s goods.</p> <h3 id="possible-extensions">Possible extensions</h3> <p>Although Keynes proposed the periodic charge to be proportional to the size of the imbalance, i.e., proportional to the $L^1$ norm, choosing a different minimization objective might be more beneficial. For example, one can use the sum of squares loss, shown below. The minimization objective is valid as long as the minimum value exists, and the objective $b_i(t)=0 \;\; \text{for } i=1,2,\cdots, n$ is met at the minimum.</p> \[\text{minimize}\sum_{t=0}^\infty||b(t)||_2^2=\sum_{t=0}^\infty\sum_{i=1}^n b_i^2(t)\] <h2 id="modeling-the-global-imbalances-problem-as-an-rl-objective">Modeling the global imbalances problem as an RL objective</h2> <p>Realism, a popular ideology in international politics, finds its ideological roots in Thomas Hobbes’ seminal work “Leviathan.” In realism, the nation is seen as the primary unit in international politics, since there is no higher authority than the state. Also, it assumes that the behavior of states is more significantly influenced by the international environment than by domestic conditions, and that the primary differentiator among nations is their relative power. Lastly, the realist perspective views international competition as inherently zero-sum, which leads to a high potential for extreme escalations in conflicts.</p> <p>Since each country is driven by its own interest, it is natural to model each nation as independent RL agents. Modeling each nation as an agent, let’s set the RL objective as follows:</p> \[\underset{\pi_i\in\mathcal{P_i}}{\text{maximize}}\; \sum_{t=0}^\infty\gamma^t \hat{R}_i(t) = {\sum_{t=0}^\infty\gamma^t\left(\tilde{R}_i(t)-\zeta|b_i(t)|\right)}\] <p>Here, $\pi_i$ is the fiscal policy of the country $i$ and $\mathcal{P}_i$ is the space of all possible monetary policies for country $i$. Given some discount factor $\gamma\in(0,1]$, each country will attempt to maximize the cumulative discounted returns, where the final reward at timestep $t$ is given by $\hat{R}_i(t)=\tilde{R}_i(t)-\zeta|b_i(t)|$. $\tilde{R}_i(t)$ represents the GDP of country $i$ at timestep $t$, and $\zeta\in \mathbb{R}_0^+$ adjusts the level of penalty given per unit Bancor and unit time.</p> <h2 id="economics-simulation">Economics simulation</h2> <p>We set our goal to calculate the GDP $\tilde{R}_i(t)$ and start with the demand. Suppose the demand of the country $i$ before shock is given by $D_i(t)$. When some shock $\beta_i(t)&gt;-1$ is present, the demand after shock becomes</p> \[\tilde{D}_i(t)=(1+\beta_i(t))D_i(t)\] <p>As an action, each country $i$, or agent $i$, selects its interest rate $I_i(t) &gt;0$ at time $t$. Then, the total demand is reduced to</p> \[\hat{D}_i(t)=\frac{1}{1+I_i(t)} \tilde{D}_i(t)\] <p>The Theory of Uncovered Interest Rate Parity (UIRP) postulates that the expected relative change of nominal foreign exchange rate between two countries $i$ and $j$ over some time interval $[t, t+\tau] \;(\tau&gt;0)$ is equal to the difference in nominal interest rates:</p> \[\frac{\mathbb{E}[E_{ij}(t+\tau)|E_{ij}(t)]}{E_{ij}(t)}=\frac{1+I_i(t)}{1+I_j(t)}\] <p>The conditional expectation on the left hand side is known to be hard to calculate, hence we will approximate it using some heuristics. If $\tau$ is large enough, we can expect the nominal exchange rate to be centered around the ratio of commodity prices between $i$ and $j$, since its economic value should be equal. Denoting the commodity price of country $i$ (denominated in its own national currency unit) at time $t$ as $P_i(t)$, We can approximate the expectation as shown in the following:</p> \[\mathbb{E}[E_{ij}(t+t_0)|E_{ij}(t)]\approx P_i(t)/P_j(t)\] <p>Substituting the expectation with the above price ratio and rearranging gives</p> \[\begin{align} \tag{∗} E_{ij}(t)=\frac{P_i(t)/P_j(t)}{(1+I_i(t))/(1+I_j(t))} \end{align}\] <p>Real commodity prices are the commodity prices denominated in same units. The real exchange rate $RE_{ij}(t)$, as distinguished from the nominal exchange rate $E_{ij}(t)$, is the ratio of real commodity prices and is given by:</p> \[RE_{ij}(t)=E_{ij}(t)(P_j(t)/P_i(t))\] <p>Substituting $(∗)$ simply gives the interest rate difference:</p> \[RE_{ij}(t)=\frac{1+I_j(t)}{1+I_i(t)}\] <p>How will the one country’s demand be distributed across products from different countries? A simple answer would be that more demand is allocated to countries with cheaper real commodity prices. We assume that when $i$ is fixed, the demand for products in country $j$ is inversely proportional to the real exchange rate $RE_{ij}(t)$. This leads to the definition of the trade coefficient:</p> \[\alpha_{ij}(t)=\frac{1/RE_{ij}(t)}{\sum_{j=1}^{n}1/RE_{ij}(t)}=\frac{RE_{ji}(t)}{\sum_{j=1}^{n}RE_{ji}(t)}\] <p>Note that $1/RE_{ij}(t)=RE_{ji}(t)$, and that $\sum_{j=1}^n \alpha_{ij}(t)=1$. Now, the total demand is then split according to the ratio $\alpha_{ij}(t)$, which then creates the flow of goods $F_{ji}(t)$ from $j$ into $i$. Here, the $\Delta$ operator is the discrete difference operator, i.e., $\Delta x(t)=x(t)-x(t-1)$.</p> \[\begin{aligned}F_{ji}(t)&amp;=\hat{D}_i(t)\alpha_{ij}(t) \\ \Delta X_{ij}(t)&amp;=F_{ij}(t)=\alpha_{ji}(t)\hat{D}_j(t)\;\;\;(i\ne j)\\ \Delta NX_{ij}(t)&amp;=\Delta X_{ij}(t)-\Delta X_{ji}(t)\end{aligned}\] <p>Country $i$’s instantaneous export, import and net export at time $t$ is given by:</p> \[\begin{aligned} EX_i(t)&amp;=\sum_{j \ne i}\Delta X_{ij}(t)=\sum_{j \ne i}\alpha_{ji}(t)\hat{D}_j(t),\;\;EX(t)=(\alpha^*)^T(t)\hat{D}(t) \\ IM_i(t)&amp;=\sum_{j \ne i}\Delta X_{ji}(t)=\sum_{j \ne i}\alpha_{ij}(t)\hat{D}_i(t),\;\;IM(t)=(\alpha^*)^S(t)\star \hat{D}(t) \\NET_i(t)&amp;=EX_i(t)-IM_i(t)\end{aligned}\] <p>The GDP $\tilde{R}_i(t)$ is then the sum of total demand and the net export:</p> \[\tilde{R}_i(t)=\hat{D}_i(t)+ NET_i(t)\] <p>And the amount of Bancors in the $i$-th country’s account is the cumulative sum of the net export:</p> \[b_i(t)=\sum_{\tau=0}^t{NET_i(t)}\] <p>The commodity prices $P_i(t)$, the inflation rates $\pi_i(t)$, and the shocks $\beta_i(t)$ are updated according to the following:</p> \[\begin{aligned} P_i(t+1) &amp;= P_i(t) \left(1+ \frac{NX_i (t)}{\hat{D} _i(t)}\right)\left(\frac{1}{1+I_i(t)}\right) \\ \pi_i{(t+1)} &amp;= \frac{P_i{(t+1)}-P_i{(t)}}{P_i{(t)}} \\ D_i{(t+1)} &amp;= \left(\frac{1}{1+\pi_i{(t+1)}}\right)D_i{(t)} \\ \beta_i(t+1) &amp;= \max\{\epsilon-1,\rho \beta_i(t)+\eta_i(t)\},\\ &amp;\text{ where }\epsilon,\rho&gt;0 \text{ and }\eta_i(t) \sim \mathcal{N}(0,\sigma^2)\end{aligned}\] <h2 id="incorporating-international-relations">Incorporating International Relations</h2> <p>International relations between countries can be implemented using the following reward sharing mechanism.</p> <p>Let $A_{ij}(t)$ denote the affinity between two countries $i$ and $j$. $A(t)=(A_{ij}(t))$ is initialized to the identity matrix $I$ at time $t_s=\max{s_i}_{i=1,2,\cdots, n}$.Two countries can increase the affinity between each other, by sending invitations and receiving them. When country $i$ sends an invitation to another country $j$, and the $j$ accepts the invitation, the affinity $A_{ij}(t)$ is increased by some $\delta&gt;0$ in the next timestep.</p> <p>The matrix $A(t)$ is set to be symmetric, with $0 \le A_{ij}(t) \le 1$ and $A_{ii}(t)=1$ for all $i,j$ and $t\ge t_s$. Multiplying $A(t)$ to the reward vector $\hat{R}(t)$ gives the shared reward $R’(t)=A(t)\hat{R}(t)=A(t)(\tilde{R}(t)-\zeta |b(t)|)$, since it is a linear combination of the rewards $R_j(t)$ with the weights of each reward proportional to $A_{ij}(t)$.</p> \[R'_i(t)=\sum_{j=1}^n A_{ij}(t)\hat{R}_j(t)\] <p>Because $A_{ii}(t)=1$ for all time $t$, the weight of the reward $R_i(t)$ is $1$. We then replace the reward in the RL objective with the shared reward $R_i’(t)$:</p> \[\begin{aligned}\underset{\pi_i\in\mathcal{P_i}}{\text{maximize}}\; \sum_{t=0}^\infty{\gamma^t R_i'(t)} &amp;= \sum_{t=0}^\infty{\gamma^t(A(t) \hat{R}(t))_i} \\ &amp;= \sum_{t=0}^\infty{\sum_{j=1}^n{A_{ij}(t)\left(\tilde{R}_j(t)-\zeta|b_j(t)|\right)}}\end{aligned}\] <p>How, specifically, does the invite-and-accept mechanism work? The action space for country $i$ when there are $n$ countries is $\mathcal{A}_i=\mathbb{R}\times\mathbb{R}^{n}\times\mathbb{R}^{n}$. When $a_i(t)=(I_i(t), P_i(t),Q_i(t))\in\mathcal{A}_i$ is selected, $I_i(t)$ is used as the interest rate, and then the invitation probabilities and the acceptance probabilities are calculated using the preferences $P_i(t)$ and $Q_i(t)$:</p> \[p_{ij}(t)=\mathrm{softmax}(P_i)_j(t)\;\;\text{and}\;\;q_{ij}(t)=\mathrm{sigmoid}(Q_i)_j(t)\] <p>In each timestep, country $i$ sends out a single invitation to one of the countries $j$, with probability $p_{ij}(t)$. Then, $q_{ij}(t)$ determines the probability that country $i$ will accept country $j$’s invitation, given that the country $j$ selected $i$. Let $U_{ij}(t)\sim (p_{ij}(t))_{j=1,2,\cdots,n}$ denote the boolean invitation matrix of whether the invitation was given from $i$ to $j$, and $V_{ij}(t)\sim \mathrm{Bernoulli}(q_{ij}(t))$ be the boolean acceptance matrix of whether $j$ accepted $i$’s invitation, if there were any. Then, the agreements made from the sending the invitation from $i$ to $j$ and accepting it, can be represented as the matrix $M_{ij}(t)$:</p> \[M_{ij}(t)=\sum_j{U^*_{ij}(t)V^*_{ij}}(t)\] <p>Where the diagonals of $U$ and $V$ are intentionally set to zero to ignore the invitation to oneself. Symmetrizing this matrix and zeroing out the diagonal gives the increment of the affinity matrix:</p> \[\Delta A_{ij}(t)=\delta(M_{ij}(t)+M_{ji}(t))\] <p>In matrix form,</p> \[\begin{aligned} M(t)&amp;=U^*(t)(V^*)^T(t) \\ \Delta A(t) &amp;= \delta(M(t)+M^T(t)) \end{aligned}\] <p>The maximum increment is $2\delta$, since the invitation can be sent and received in both directions. To be certain that $0 \le A_{ij}(t) \le 1$, $\delta&gt;0$ is chosen so that $(2\delta) T\le1$ for the total number of timesteps, $T$.</p> <h2 id="code">Code</h2> <p><a href="https://github.com/codingJang/SOUL_project/blob/main/Source/Prototypes/PrototypeVer2/economics_env.py" rel="external nofollow noopener" target="_blank"><strong>economic_env.py</strong></a>: The economics environment for the RL agents is implemented using PettingZoo.</p> <p><a href="https://github.com/codingJang/SOUL_project/blob/main/Source/Prototypes/PrototypeVer1/politics_env.py" rel="external nofollow noopener" target="_blank"><strong>politics_env.py</strong></a>: The reward sharing mechanism is tested for randomly generated rewards.</p> <p><a href="https://github.com/codingJang/SOUL_project/blob/main/Source/Prototypes/PrototypeVer2/APPO.py" rel="external nofollow noopener" target="_blank"><strong>APPO.py:</strong></a> The RL agent is created and trained using Ray RLlib, using APPO+LSTM combination.</p> <p><a href="https://github.com/codingJang/SOUL_project/blob/main/Source/Prototypes/PrototypeVer2/load_and_play_ui.py" rel="external nofollow noopener" target="_blank"><strong>load_and_play_ui.py</strong></a>: The trained model is loaded and tested in the economics environment, with one of the agent’s action replaced with human input.</p> <p><a href="https://github.com/codingJang/SOUL_project/tree/main/Source/PreprocessingInternationalRelationsData" rel="external nofollow noopener" target="_blank"><strong>PreprocessingInternationalRelationsData</strong></a>: The affinity matrix $A_{ij}(t)$, which is initialized to the identity matrix $I$, may be replaced with the IGO_adjmat.csv or DCAD_adjmat.csv, which are created by preprocessing the Intergovernmental Organization (IGO) dataset or the Defense Cooperation Agreement Dataset (DCAD), respectively.</p> <h2 id="experiments">Experiments</h2> <p>Training results are not as expected, and debugging is in progress. Further investigation of the simulation is necessary.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/information-compression-neural-networks-and-ai-for-science/">Toward a Unified Theory</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/signing-right-away/">Signing Right Away</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/ai-science-and-humanities-kr/">인공지능과 과학, 그리고 인문학</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/ai-science-and-humanities-copy/">AI, Science, and the Humanities</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Yejun Jang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>